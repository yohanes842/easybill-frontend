<div>
  <p-dataView
    #dv
    [style]="{ 'background-color': 'white !important' }"
    [value]="orders"
    [paginator]="true"
    [rows]="9"
    filterBy="order_description,user.username"
    layout="grid"
  >
    <ng-template pTemplate="header">
      <div
        class="flex flex-row justify-content-between align-items-center gap-3 mb-1"
      >
        <span class="p-input-icon-left mb-0 w-full">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="search"
            placeholder="Search by buyer name or description ..."
            (input)="dv.filter(getValue($event))"
            class="w-full py-2"
          />
        </span>
        <button
          pButton
          class="p-button bg-primary p-button-sm px-0"
          icon="pi pi-plus"
          (click)="navigateToAddOrdersForm()"
        ></button>
      </div>
      <div class="flex align-items-center justify-content-between">
        <h2 class="m-0 font-italic">Order History</h2>
        <p-dropdown
          [style]="{ padding: '0rem', transform: 'scale(0.75)' }"
          [panelStyle]="{ padding: '0rem' }"
          placeholder="Sort by time"
        ></p-dropdown>
      </div>
    </ng-template>
    <ng-template
      let-order
      pTemplate="gridItem"
      class="flex flex-column bg-red-300"
    >
      <div
        class="p-col-12 w-full px-3 mb-3 mx-3 border-round"
        style="background: var(--custom-light-black)"
      >
        <div>
          <div class="flex justify-content-between align-items-center">
            <p class="p-0 m-0 mt-1 text-sm text-gray-400">
              {{ order.order_at | date: "EEEE, d/M/yy yy, h:mm a" }}
            </p>
            <p
              class="p-0 w-3rem border-round text-center text-sm font-italic text-green-600"
            >
              all paid
            </p>
          </div>

          <div class="flex justify-content-between">
            <div>
              <h4 class="m-0" style="color: var(--custom-light-green)">
                {{ order.order_description }}
              </h4>
              <p class="m-0 text-sm" style="color: var(--custom-light-green)">
                by
                <span>
                  <p-avatar
                    styleClass="p-mr-2"
                    [style]="{
                      'background-color': 'var(--pink-200)',
                      color: '#ffffff',
                      transform: 'scale(70%)'
                    }"
                    shape="circle"
                    >{{
                      order.user.username | uppercase | slice: 0:1
                    }}</p-avatar
                  >
                </span>
                <span>{{ order.user.username | uppercase }}</span>
              </p>
            </div>
          </div>
        </div>
        <div class="text-right h-fit">
          <button
            pButton
            class="p-button-sm p-button-link p-0 mb-3"
            type="button"
            label="Tap for details"
            (click)="onShowDetail(order)"
          ></button>
        </div>
      </div>
    </ng-template>
  </p-dataView>
</div>

<dialog-order-details
  *ngIf="display"
  [selectedOrder]="selectedOrder"
  (close)="onHideDetail()"
></dialog-order-details>
